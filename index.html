<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no, maximum-scale=1.0">
    <title>Showdown Poker</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', 'Roboto', sans-serif;
            background: linear-gradient(135deg, #1e3c72, #2a5298);
            color: white;
            min-height: 100vh;
            margin: 0;
            padding: 0;
            display: flex;
            justify-content: center;
            align-items: center;
            overflow-x: hidden;
            -webkit-text-size-adjust: 100%;
            -webkit-font-smoothing: antialiased;
        }

        .container {
            width: 100vw;
            height: 100vh;
            padding: 8px;
            box-sizing: border-box;
            overflow: hidden;
        }

        .screen {
            display: none;
            width: 100%;
            height: 100%;
            padding: 16px;
            box-sizing: border-box;
            background: rgba(255, 255, 255, 0.1);
            border-radius: 12px;
            backdrop-filter: blur(10px);
            overflow-y: auto;
            text-align: center;
        }

        .screen.active {
            display: block;
        }

        h1 {
            font-size: 24px;
            margin: 16px 0;
            color: #ffd700;
            text-shadow: 2px 2px 4px rgba(0, 0, 0, 0.5);
        }

        h2 {
            font-size: 18px;
            margin: 12px 0;
        }

        h3 {
            font-size: 16px;
            margin: 8px 0;
        }

        button {
            background: linear-gradient(45deg, #ff6b6b, #ee5a24);
            border: none;
            border-radius: 8px;
            padding: 12px 20px;
            font-size: 14px;
            color: white;
            cursor: pointer;
            margin: 6px;
            transition: all 0.3s ease;
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.2);
            min-height: 44px;
            min-width: 80px;
        }

        .nickname-input {
            padding: 12px 16px;
            font-size: 16px;
            border: none;
            border-radius: 8px;
            margin: 16px 0;
            text-align: center;
            background: rgba(255, 255, 255, 0.9);
            color: #333;
            width: 250px;
            max-width: 90%;
        }

        /* Í≤åÏûÑ ÌôîÎ©¥ - Îã®ÏàúÌïú ÏÑ∏Î°ú Î†àÏù¥ÏïÑÏõÉ */
        .game-area {
            display: flex;
            flex-direction: column;
            height: calc(100vh - 40px);
            gap: 12px;
            padding: 0;
        }

        .game-info {
            display: flex;
            justify-content: space-between;
            align-items: center;
            background: rgba(255, 255, 255, 0.1);
            padding: 8px 12px;
            border-radius: 8px;
            font-size: 12px;
            flex-shrink: 0;
        }

        .card-piles {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 0 20px;
            flex-shrink: 0;
        }

        .pile-image {
            width: 45px;
            height: 65px;
            border-radius: 6px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 10px;
            color: white;
            text-align: center;
        }

        .pile-deck {
            background: linear-gradient(45deg, #2c5aa0, #1e3c72);
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.3);
        }

        .pile-discard {
            background: linear-gradient(45deg, #8e44ad, #9b59b6);
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.3);
        }

        .player-area {
            flex: 1;
            display: flex;
            flex-direction: column;
            justify-content: space-around;
            gap: 8px;
            min-height: 0;
        }

        .player-section {
            flex: 1;
            display: flex;
            flex-direction: column;
            justify-content: center;
            gap: 8px;
        }

        .hand {
            display: flex;
            justify-content: center;
            gap: 4px;
            padding: 0 8px;
            flex-wrap: nowrap;
        }

        .card {
            width: 50px;
            height: 70px;
            background: white;
            border: 1px solid #333;
            border-radius: 4px;
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            cursor: pointer;
            transition: all 0.3s ease;
            color: #333;
            font-weight: bold;
            font-size: 11px;
            position: relative;
            user-select: none;
            -webkit-user-select: none;
            -webkit-tap-highlight-color: transparent;
        }

        .card.selected {
            border-color: #e74c3c;
            box-shadow: 0 0 8px rgba(231, 76, 60, 0.6);
            background: #ffe6e6;
            transform: translateY(-4px);
        }

        .card.red {
            color: #e74c3c;
        }

        .card.black {
            color: #2c3e50;
        }

        .card.joker {
            background: linear-gradient(45deg, #ff6b6b, #4ecdc4);
            color: white;
            font-size: 12px;
        }

        .card-back {
            background: linear-gradient(45deg, #2c5aa0, #1e3c72);
            color: white;
        }

        .controls {
            display: flex;
            justify-content: center;
            gap: 8px;
            flex-wrap: wrap;
            padding: 8px;
            flex-shrink: 0;
        }

        .result {
            background: rgba(255, 255, 255, 0.2);
            padding: 8px;
            border-radius: 6px;
            margin: 4px 0;
            font-size: 11px;
        }

        .result h3, .result h4 {
            color: #ffd700;
            margin-bottom: 4px;
            font-size: 12px;
        }

        .ranking {
            margin-top: 16px;
            text-align: left;
            max-width: 400px;
            margin-left: auto;
            margin-right: auto;
        }

        .ranking h2 {
            text-align: center;
            margin-bottom: 12px;
            color: #ffd700;
            font-size: 18px;
        }

        .ranking-item {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 8px 12px;
            margin: 4px 0;
            background: rgba(255, 255, 255, 0.1);
            border-radius: 6px;
            font-size: 12px;
        }

        .ranking-item:first-child {
            background: rgba(255, 215, 0, 0.2);
            border: 1px solid #ffd700;
        }

        /* Ïï†ÎãàÎ©îÏù¥ÏÖò Îã®ÏàúÌôî */
        @keyframes cardFlip {
            0% { transform: rotateY(0deg); }
            50% { transform: rotateY(90deg); }
            100% { transform: rotateY(0deg); }
        }

        .card.flip {
            animation: cardFlip 0.6s ease;
        }

        @keyframes flyToPile {
            from { transform: translateX(0) translateY(0) scale(1); opacity: 1; }
            to { transform: translateX(-200px) translateY(0) scale(0.5); opacity: 0; }
        }

        @keyframes flyFromPile {
            from { transform: translateX(200px) translateY(0) scale(0.5); opacity: 0; }
            to { transform: translateX(0) translateY(0) scale(1); opacity: 1; }
        }

        .card.flying-to-pile {
            animation: flyToPile 0.8s ease-out forwards;
        }

        .card.flying-from-pile {
            animation: flyFromPile 0.8s ease-out forwards;
        }

        /* Î™®Î∞îÏùºÏóêÏÑú Ìò∏Î≤Ñ Ìö®Í≥º Ï†úÍ±∞ */
        @media (hover: none) {
            button:hover {
                transform: none;
                box-shadow: 0 4px 15px rgba(0, 0, 0, 0.2);
            }
        }

        /* Î™®Î∞îÏùº Ï†ÑÏö© ÏµúÏ†ÅÌôî Ï†úÍ±∞ - Îã®ÏàúÌôîÎêú Î∞òÏùëÌòï */
        @media (max-width: 768px) {
            .card {
                width: 45px;
                height: 63px;
                font-size: 10px;
            }
            
            .hand {
                gap: 3px;
            }
            
            .game-info {
                font-size: 11px;
                padding: 6px 10px;
            }
            
            button {
                padding: 10px 16px;
                font-size: 13px;
                margin: 4px;
            }
            
            .pile-image {
                width: 40px;
                height: 56px;
                font-size: 9px;
            }
        }

        @media (max-width: 400px) {
            .card {
                width: 40px;
                height: 56px;
                font-size: 9px;
            }
            
            .hand {
                gap: 2px;
            }
            
            .game-info {
                font-size: 10px;
                padding: 4px 8px;
            }
            
            button {
                padding: 8px 12px;
                font-size: 12px;
                margin: 3px;
            }
            
            .pile-image {
                width: 35px;
                height: 49px;
                font-size: 8px;
            }
            
            .container {
                padding: 4px;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <!-- ÎãâÎÑ§ÏûÑ ÏûÖÎ†• ÌôîÎ©¥ -->
        <div class="screen active" id="nicknameScreen">
            <h1>üÉè Showdown Poker üÉè</h1>
            <h2>ÎãâÎÑ§ÏûÑÏùÑ ÏûÖÎ†•ÌïòÍ≥† Í≤åÏûÑÏùÑ ÏãúÏûëÌïòÏÑ∏Ïöî</h2>
            <input type="text" class="nickname-input" id="nicknameInput" placeholder="ÎãâÎÑ§ÏûÑ ÏûÖÎ†•" maxlength="10">
            <br>
            <button onclick="startGame()">Í≤åÏûÑ ÏãúÏûë</button>
            <button onclick="showRanking()">Îû≠ÌÇπ Î≥¥Í∏∞</button>
        </div>

        <!-- Îû≠ÌÇπ ÌôîÎ©¥ -->
        <div class="screen" id="rankingScreen">
            <h1>üèÜ Îû≠ÌÇπ üèÜ</h1>
            <div class="ranking">
                <div id="rankingList">
                    <div class="ranking-item">
                        <span>ÏàúÏúÑÎ•º Î∂àÎü¨Ïò§Îäî Ï§ë...</span>
                    </div>
                </div>
            </div>
            <button onclick="showNicknameInput()">ÎèåÏïÑÍ∞ÄÍ∏∞</button>
        </div>

        <!-- Í≤åÏûÑ ÌôîÎ©¥ -->
        <div class="screen" id="gameScreen">
            <div class="game-area">
                <!-- Í≤åÏûÑ Ï†ïÎ≥¥ -->
                <div class="game-info">
                    <div>
                        <div>ÌîåÎ†àÏù¥Ïñ¥: <span id="playerName"></span></div>
                        <div>Ï†êÏàò: <span id="playerScore">0</span></div>
                    </div>
                    <div>
                        <div>ÎùºÏö¥Îìú: <span id="currentRound">1</span> / 5</div>
                        <div>ÍµêÌôò: <span id="exchangesLeft">3</span></div>
                    </div>
                    <div>
                        <div>Ïª¥Ìì®ÌÑ∞: <span id="computerScore">0</span></div>
                    </div>
                </div>

                <!-- Ïπ¥ÎìúÎçîÎØ∏Îì§ -->
                <div class="card-piles">
                    <div class="pile-image pile-discard">
                        <div>Î≤ÑÎ¶∞<br>Ïπ¥Îìú</div>
                    </div>
                    <div class="pile-image pile-deck">
                        <div>Ïπ¥Îìú<br>Îç±</div>
                    </div>
                </div>

                <!-- ÌîåÎ†àÏù¥Ïñ¥ ÏòÅÏó≠ -->
                <div class="player-area">
                    <div class="player-section">
                        <h3>Ïª¥Ìì®ÌÑ∞ Ïπ¥Îìú</h3>
                        <div class="hand" id="computerHand"></div>
                        <div class="result" id="computerResult"></div>
                    </div>
                    
                    <div class="player-section">
                        <h3>ÎÇ¥ Ïπ¥Îìú (ÌÑ∞ÏπòÌïòÏó¨ ÍµêÏ≤¥ ÏÑ†ÌÉù)</h3>
                        <div class="hand" id="playerHand"></div>
                        <div class="result" id="playerCurrentHand">
                            <h4>ÌòÑÏû¨ Ìå®: <span id="currentHandRank">-</span></h4>
                            <p>ÏòàÏÉÅ Ï†êÏàò: <span id="currentHandScore">0</span>Ï†ê</p>
                        </div>
                        <div class="result" id="playerResult"></div>
                    </div>
                </div>

                <!-- Ïª®Ìä∏Î°§ Î≤ÑÌäºÎì§ -->
                <div class="controls">
                    <button id="exchangeBtn" onclick="exchangeCards()">Ïπ¥Îìú ÍµêÌôò</button>
                    <button id="finishRoundBtn" onclick="finishRound()" style="display: none;">ÎùºÏö¥Îìú ÏôÑÎ£å</button>
                    <button id="nextRoundBtn" onclick="nextRound()" style="display: none;">Îã§Ïùå ÎùºÏö¥Îìú</button>
                    <button id="newGameBtn" onclick="showNewGameOptions()" style="display: none;">Í≤åÏûÑ ÏôÑÎ£å</button>
                    <button onclick="showNicknameInput()">ÏÉà Í≤åÏûÑ</button>
                </div>
            </div>
        </div>

        <!-- Í≤åÏûÑ ÏôÑÎ£å ÌôîÎ©¥ -->
        <div class="screen" id="gameCompleteScreen">
            <h1 id="gameResult"></h1>
            <div id="finalScores"></div>
            
            <div class="ranking">
                <h2>üèÜ ÏµúÏ¢Ö Îû≠ÌÇπ üèÜ</h2>
                <div id="finalRankingList">
                    <div class="ranking-item">
                        <span>ÏàúÏúÑÎ•º Î∂àÎü¨Ïò§Îäî Ï§ë...</span>
                    </div>
                </div>
            </div>
            
            <button onclick="startNewGame()">ÏÉà Í≤åÏûÑ</button>
        </div>
    </div>

    <script>
        // Í≤åÏûÑ ÏÉÅÌÉú Î≥ÄÏàò
        let currentPlayer = '';
        let currentRound = 1;
        let playerScore = 0;
        let computerScore = 0;
        let playerHand = [];
        let computerHand = [];
        let deck = [];
        let exchangesLeft = 3;
        let computerExchangesLeft = 3;
        let roundComplete = false;

        // Ïπ¥Îìú ÏÉùÏÑ± - ÌäπÏàòÎ¨∏Ïûê ÎåÄÏã† ÌÖçÏä§Ìä∏ ÏÇ¨Ïö©
        const suits = ['H', 'D', 'C', 'S']; // Hearts, Diamonds, Clubs, Spades
        const suitNames = ['hearts', 'diamonds', 'clubs', 'spades'];
        const suitSymbols = ['‚ô•', '‚ô¶', '‚ô£', '‚ô†'];
        const ranks = ['A', '2', '3', '4', '5', '6', '7', '8', '9', '10', 'J', 'Q', 'K'];

        class Card {
            constructor(suit, rank, isJoker = false) {
                this.suit = suit;
                this.rank = rank;
                this.isJoker = isJoker;
                this.isFixed = false;
                this.isSelected = false; // ÍµêÏ≤¥ ÏÑ†ÌÉù ÏÉÅÌÉú
                this.value = isJoker ? 0 : (rank === 'A' ? 1 : (rank === 'J' ? 11 : (rank === 'Q' ? 12 : (rank === 'K' ? 13 : parseInt(rank)))));
            }

            toString() {
                if (this.isJoker) return 'JOKER';
                
                // Î™®Î∞îÏùºÏóêÏÑú ÏïàÏ†ÑÌïú ÌëúÏãú
                let suitSymbol;
                switch(this.suit) {
                    case 'H': suitSymbol = 'H'; break; // Hearts
                    case 'D': suitSymbol = 'D'; break; // Diamonds  
                    case 'C': suitSymbol = 'C'; break; // Clubs
                    case 'S': suitSymbol = 'S'; break; // Spades
                    default: suitSymbol = this.suit;
                }
                
                return `${this.rank}${suitSymbol}`;
            }

            getColor() {
                if (this.isJoker) return 'joker';
                return (this.suit === 'H' || this.suit === 'D') ? 'red' : 'black';
            }
        }

        // Îç± ÏÉùÏÑ± Ìï®Ïàò
        function createDeck() {
            deck = [];
            for (let i = 0; i < 4; i++) {
                for (let j = 0; j < 13; j++) {
                    deck.push(new Card(suits[i], ranks[j]));
                }
            }
            deck.push(new Card('', 'JOKER', true)); // Ï°∞Ïª§ Ï∂îÍ∞Ä
        }

        // Îç± ÏÖîÌîå
        function shuffleDeck() {
            for (let i = deck.length - 1; i > 0; i--) {
                const j = Math.floor(Math.random() * (i + 1));
                [deck[i], deck[j]] = [deck[j], deck[i]];
            }
        }

        // Ïπ¥Îìú 5Ïû• Î∞∞Î∂Ñ
        function dealCards() {
            playerHand = [];
            computerHand = [];
            for (let i = 0; i < 5; i++) {
                playerHand.push(deck.pop());
                computerHand.push(deck.pop());
            }
        }

        // Ìè¨Ïª§ Ï°±Î≥¥ ÌåêÏ†ï
        function evaluateHand(hand) {
            const counts = {};
            const suits = {};
            let hasJoker = false;
            
            // Ï°∞Ïª§ ÌôïÏù∏ Î∞è Ïπ¥Îìú Î∂ÑÏÑù
            hand.forEach(card => {
                if (card.isJoker) {
                    hasJoker = true;
                } else {
                    counts[card.value] = (counts[card.value] || 0) + 1;
                    suits[card.suit] = (suits[card.suit] || 0) + 1;
                }
            });

            const values = Object.keys(counts).map(k => parseInt(k)).sort((a, b) => a - b);
            const countValues = Object.values(counts).sort((a, b) => b - a);
            const suitCounts = Object.values(suits);
            
            // Ï°∞Ïª§Î•º ÌôúÏö©Ìïú ÏµúÏ†Å Ï°±Î≥¥ Ï∞æÍ∏∞
            if (hasJoker) {
                return evaluateWithJoker(counts, suits, values, suitCounts);
            }

            return evaluateNormalHand(counts, suits, values, countValues, suitCounts);
        }

        function evaluateWithJoker(counts, suits, values, suitCounts) {
            // Ï°∞Ïª§Í∞Ä ÏûàÏùÑ Îïå Í∞ÄÎä•Ìïú ÏµúÍ≥† Ï°±Î≥¥Î•º Ï∞æÏùå
            const countValues = Object.values(counts).sort((a, b) => b - a);
            
            // Ïä§Ìä∏Î†àÏù¥Ìä∏ Í∞ÄÎä•ÏÑ±ÏùÑ Î®ºÏ†Ä Ï≤¥ÌÅ¨ (Ï°∞Ïª§Î°ú Ïó∞Í≤∞ Í∞ÄÎä•ÌïúÏßÄ)
            const straightResult = checkStraightWithJoker(values, suitCounts);
            if (straightResult.isStraight) {
                if (straightResult.isFlush) {
                    if (straightResult.isRoyal) {
                        return { rank: 10, name: 'Î°úÏñÑ ÌîåÎü¨Ïãú', score: 1000 };
                    }
                    return { rank: 9, name: 'Ïä§Ìä∏Î†àÏù¥Ìä∏ ÌîåÎü¨Ïãú', score: 900 };
                }
                return { rank: 5, name: 'Ïä§Ìä∏Î†àÏù¥Ìä∏', score: 500 };
            }
            
            // ÌîåÎü¨Ïãú Í∞ÄÎä•ÏÑ± Ï≤¥ÌÅ¨ (Í∞ôÏùÄ Î¨¥Îä¨ 4Ïû• + Ï°∞Ïª§)
            if (suitCounts.length === 1 && suitCounts[0] === 4) {
                return { rank: 6, name: 'ÌîåÎü¨Ïãú', score: 600 };
            }
            
            // Ìè¨Ïπ¥Îìú Í∞ÄÎä•ÏÑ± (Í∞ôÏùÄ Ïà´Ïûê 3Ïû• + Ï°∞Ïª§)
            if (countValues.length > 0 && countValues[0] === 3) {
                return { rank: 8, name: 'Ìè¨Ïπ¥Îìú', score: 800 };
            }
            
            // ÌíÄÌïòÏö∞Ïä§ Í∞ÄÎä•ÏÑ± (2ÌéòÏñ¥ + Ï°∞Ïª§Î°ú ÌïúÏ™ΩÏùÑ Ìä∏Î¶¨ÌîåÎ°ú)
            if (countValues.length >= 2 && countValues[0] === 2 && countValues[1] === 2) {
                return { rank: 7, name: 'ÌíÄÌïòÏö∞Ïä§', score: 700 };
            }
            
            // Ìä∏Î¶¨Ìîå Í∞ÄÎä•ÏÑ± (Í∞ôÏùÄ Ïà´Ïûê 2Ïû• + Ï°∞Ïª§)
            if (countValues.length > 0 && countValues[0] === 2) {
                return { rank: 4, name: 'Ìä∏Î¶¨Ìîå', score: 400 };
            }
            
            // Ìà¨ÌéòÏñ¥ Í∞ÄÎä•ÏÑ± (Ïù¥ÎØ∏ 1ÌéòÏñ¥Í∞Ä ÏûàÏñ¥Ïïº Ï°∞Ïª§Î°ú Îã§Î•∏ ÌéòÏñ¥ ÏÉùÏÑ±)
            // Î™®Îì† Ïπ¥ÎìúÍ∞Ä Îã§Î•∏ Ïà´ÏûêÎ©¥ Ï°∞Ïª§Î°úÎäî ÏõêÌéòÏñ¥Îßå Í∞ÄÎä•
            if (countValues.length > 0 && countValues[0] === 1) {
                // Î™®Îì† Ïπ¥ÎìúÍ∞Ä ÏÑúÎ°ú Îã§Î•∏ Í≤ΩÏö∞ - Ï°∞Ïª§Î°ú ÏõêÌéòÏñ¥Îßå Í∞ÄÎä•
                return { rank: 2, name: 'ÏõêÌéòÏñ¥', score: 200 };
            }
            
            // Í∏∞Î≥∏Ï†ÅÏúºÎ°ú Ï°∞Ïª§Í∞Ä ÏûàÏúºÎ©¥ ÏµúÏÜåÌïú ÏõêÌéòÏñ¥Îäî Î≥¥Ïû•
            return { rank: 2, name: 'ÏõêÌéòÏñ¥', score: 200 };
        }

        function checkStraightWithJoker(values, suitCounts) {
            if (values.length < 4) return { isStraight: false, isFlush: false, isRoyal: false };
            
            const sortedValues = [...values].sort((a, b) => a - b);
            const isFlush = suitCounts.length === 1 && suitCounts[0] === 4;
            
            // Í∞ÄÎä•Ìïú Î™®Îì† Ïó∞ÏÜç 5Ïû• Ïä§Ìä∏Î†àÏù¥Ìä∏ Ìå®ÌÑ¥ ÌôïÏù∏
            const straightPatterns = [
                [1, 2, 3, 4, 5],    // A-2-3-4-5
                [2, 3, 4, 5, 6],    // 2-3-4-5-6
                [3, 4, 5, 6, 7],    // 3-4-5-6-7
                [4, 5, 6, 7, 8],    // 4-5-6-7-8
                [5, 6, 7, 8, 9],    // 5-6-7-8-9
                [6, 7, 8, 9, 10],   // 6-7-8-9-10
                [7, 8, 9, 10, 11],  // 7-8-9-10-J
                [8, 9, 10, 11, 12], // 8-9-10-J-Q
                [9, 10, 11, 12, 13], // 9-10-J-Q-K
                [10, 11, 12, 13, 1]  // 10-J-Q-K-A (AÎ•º 14Î°ú Ï∑®Í∏â)
            ];
            
            for (const pattern of straightPatterns) {
                // 10-J-Q-K-A Ìå®ÌÑ¥Ïùò Í≤ΩÏö∞ AÎ•º 14Î°ú Î≥ÄÌôòÌïòÏó¨ ÎπÑÍµê
                let adjustedPattern = [...pattern];
                let adjustedValues = [...sortedValues];
                
                if (pattern.includes(10) && pattern.includes(1)) {
                    // Î°úÏñÑ Ïä§Ìä∏Î†àÏù¥Ìä∏Ïùò Í≤ΩÏö∞ AÎ•º 14Î°ú Ï≤òÎ¶¨
                    adjustedPattern = pattern.map(v => v === 1 ? 14 : v);
                    adjustedValues = sortedValues.map(v => v === 1 ? 14 : v);
                }
                
                let matchCount = 0;
                for (const value of adjustedPattern) {
                    if (adjustedValues.includes(value)) {
                        matchCount++;
                    }
                }
                
                // Ï†ïÌôïÌûà 4Ïû•Ïù¥ Îß§ÏπòÎêòÎ©¥ Ï°∞Ïª§Î°ú 1Ïû• Î≥¥ÏôÑÌïòÏó¨ Ïä§Ìä∏Î†àÏù¥Ìä∏ ÏôÑÏÑ±
                if (matchCount === 4) {
                    const isRoyal = pattern.includes(1) && pattern.includes(10) && 
                                  pattern.includes(11) && pattern.includes(12) && pattern.includes(13);
                    return { 
                        isStraight: true, 
                        isFlush: isFlush, 
                        isRoyal: isRoyal && isFlush 
                    };
                }
            }
            
            return { isStraight: false, isFlush: isFlush, isRoyal: false };
        }

        function evaluateNormalHand(counts, suits, values, countValues, suitCounts) {
            const isFlush = suitCounts.length === 1;
            const isStraight = checkStraight(values);
            
            // Î°úÏñÑ ÌîåÎü¨Ïãú
            if (isFlush && isStraight && values.includes(1) && values.includes(10)) {
                return { rank: 10, name: 'Î°úÏñÑ ÌîåÎü¨Ïãú', score: 1000 };
            }
            
            // Ïä§Ìä∏Î†àÏù¥Ìä∏ ÌîåÎü¨Ïãú
            if (isFlush && isStraight) {
                return { rank: 9, name: 'Ïä§Ìä∏Î†àÏù¥Ìä∏ ÌîåÎü¨Ïãú', score: 900 };
            }
            
            // Ìè¨Ïπ¥Îìú
            if (countValues[0] === 4) {
                return { rank: 8, name: 'Ìè¨Ïπ¥Îìú', score: 800 };
            }
            
            // ÌíÄÌïòÏö∞Ïä§
            if (countValues[0] === 3 && countValues[1] === 2) {
                return { rank: 7, name: 'ÌíÄÌïòÏö∞Ïä§', score: 700 };
            }
            
            // ÌîåÎü¨Ïãú
            if (isFlush) {
                return { rank: 6, name: 'ÌîåÎü¨Ïãú', score: 600 };
            }
            
            // Ïä§Ìä∏Î†àÏù¥Ìä∏
            if (isStraight) {
                return { rank: 5, name: 'Ïä§Ìä∏Î†àÏù¥Ìä∏', score: 500 };
            }
            
            // Ìä∏Î¶¨Ìîå
            if (countValues[0] === 3) {
                return { rank: 4, name: 'Ìä∏Î¶¨Ìîå', score: 400 };
            }
            
            // Ìà¨ÌéòÏñ¥
            if (countValues[0] === 2 && countValues[1] === 2) {
                return { rank: 3, name: 'Ìà¨ÌéòÏñ¥', score: 300 };
            }
            
            // ÏõêÌéòÏñ¥
            if (countValues[0] === 2) {
                return { rank: 2, name: 'ÏõêÌéòÏñ¥', score: 200 };
            }
            
            // ÌïòÏù¥Ïπ¥Îìú
            return { rank: 1, name: 'ÌïòÏù¥Ïπ¥Îìú', score: Math.max(...values) * 10 };
        }

        function checkStraight(values) {
            if (values.length !== 5) return false;
            
            // ÏùºÎ∞ò
